**Домашнее задание**  
Оконные функции (задание для QA)  

Цель:  
научиться проектировать, использовать и анализировать оконные функции с учётом граничных случаев;  


Описание/Пошаговая инструкция выполнения домашнего задания:  
Для этого домашнего занятия вам понадобятся пустые таблицы:  
```
CREATE TABLE stores (
    store_id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    address VARCHAR(50) NOT NULL
);

CREATE TABLE sales (
    sale_id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    store_id BIGINT REFERENCES stores (store_id),
    date TIMESTAMP NOT NULL,
    sale_amount DECIMAL(10,2) NOT NULL
);
```
Напишите хранимую процедуру (или скрипт на любом языке программирования) со следующей функциональностью:  
сгенерировать 10 магазинов в таблице stores  
сгенерировать 100000 продаж в таблице sales за последние 2 года  
продажи должны быть распределены НЕРАВНОМЕРНО между магазинами (70-75% продаж должны быть в каком-то одном магазине)  
Напишите запрос, который выведет нарастающий итог продаж по каждому магазину с группировкой по месяцам.  

Напишите запрос, который выведет 7-дневное скользящее среднее за последний месяц по самому плодовитому магазину.  

Опишите, какие граничные случаи вы учли в своих запросах:  

Решение:  


по нарастающему итогу часть информации была на занятии
по скользящему среднему нужно подумать самостоятельно
